<script>

// Add user button
$(document).ready(function() {
	$("#Adduser_But").click(function() {
    	$("#AddUser_Box").show(400);
	}); 
});

// Cancel icon create user box
$(document).ready(function() { 
	$(".cancel_Icon").click(function() {
        
        var action = $(this).prop('name');
        
        console.log(action);
        
        if(action == 'edit'){
		  $("#editUser_Box").hide(400);
        }
        else{ 
          $("#AddUser_Box").hide(400);
        } 
    }); 
});

// Post create user data
$(document).ready(function() {
	$("#Submit_CreateUser").click(function() {
		var data = $('#CreateUserForm').serializeJSON();    
    	console.log(data);
      
      	jQuery.ajax({
			url : "api/opr/addopr",
			data : data,
			contentType: "application/json",
			method: 'POST',
			success : function(data) {
          		console.log(data);
          	  	$('#CreateMSG').html(data);
           	 	loadUsers();
			},
			error: function(jqXHR, text, error) { 
            	console.log(data);
            	$('#CreateMSG').html(data).fadeToggle(500);
             	$("#AddUser_Box").show(400);
			}
		});  
	});   
});

// Refresh button
$(document).ready(function() {
	$("#refresh_But").click(function() {       
    	console.log('Refreshing users.'); 
    	loadUsers();
	});
});

// Create dummy user  
$(document).ready(function() {
	$("#Submit_CreateUser_dummy").click(function() {
		
		$('#oprId').val(Math.floor((Math.random() * 900) + 100));
        $('#oprFirstName').val('Dum');
        $('#oprLastName').val('Dummy');
        $('#oprIni').val('DD');
        $('#oprEmail').val('dum@dummy.com');
        $('#oprCpr').val('oprCpr');
        $('#oprPassword').val('pass');
        $('#oprRole1').val('None');
        
        // Adding roles to dummy user.
        $('#adminRole').prop('checked', true);
        $('#farmaceutRole').prop('checked', true);
        $('#vaerkRole').prop('checked', true);
        $('#laborantRole').prop('checked', true);
        
        var data = $('#CreateUserForm').serializeJSON();    
      
      	jQuery.ajax({
			url : "api/opr/addopr",
			data : data,
			contentType: "application/json",
			method: 'POST',
			success : function(data) {
            	console.log(data);
            	$('#CreateMSG').html(data);
           		loadUsers();
			},
			error: function(jqXHR, text, error){ 
           		console.log(data);
            	$('#CreateMSG').html(data).fadeToggle(500);
            	$("#AddUser_Box").show();
			}
		}); 
  	});   
});

</script>

<!--create user popup-->
<div id="AddUser_Box" class="popup_box">
  <img name="add" class="cancel_Icon" src="assets/img/cancel_icon.png"> 
    <h1>Add User</h1>
  <form id="CreateUserForm" method="POST" action="api/opr/addopr">
  
    Id <br>
    <input type="text" name="oprId" id="oprId">
    <br>
  	First Name <br>
    <input type="text" name="oprFirstName" id="oprFirstName">	
    <br>
    Last Name <br>
    <input type="text" name="oprLastName" id="oprLastName">	
    <br>
    Initials <br>
    <input type="text" name="oprIni" id="oprIni">
    <br>
    E-mail <br>
    <input type="text" name="oprEmail" id="oprEmail">	
    <br>
    Cpr <br>
    <input type="text" name="oprCpr" id="oprCpr">
    <br>
    Password <br>
    <input type="text" name="oprPassword" id="oprPassword">
    <br>
  
    Privileges <br>
     <input type="checkbox" name="adminRole" id="adminRole"> Admin<br>
     <input type="checkbox" name="farmaceutRole" id="farmaceutRole"> Farmaceut<br>
     <input type="checkbox" name="vaerkRole" id="vaerkRole"> Værkfører<br>
     <input type="checkbox" name="laborantRole" id="laborantRole"> Laborant <br>  
  	<br>
  	<br>
  	
  	<input id="Submit_CreateUser" type="button" value="Add user">
    <input id="Submit_CreateUser_dummy" type="button" value="Add Dummy user">
    
    <p id="msg"></p>
    <p id="CreateMSG"></p>
</form> 
</div>
<!--create user popup slut--> 

<!--edit user popup-->
<div id="editUser_Box" class="popup_box">
  <img name="edit" class="cancel_Icon" src="assets/img/cancel_icon.png">  
    <h1>Edit User</h1>
  <form id="editUserForm" method="POST">
  Status <br>
      <select id="statusEdit" name="status">
  <option value="0">Active</option>
  <option value="1">Inactive</option>
      </select> <br><br>
    Id:  
       <label name="oprIdLabel" id="oprIdEdit">id...</label>
    <br>
  	First Name <br>
    <input type="text" name="oprFirstName" id="oprFirstNameEdit">	
    <br>
    Last Name <br>
    <input type="text" name="oprLastName" id="oprLastNameEdit">	
    <br>
    Initials <br>
    <input type="text" name="oprIni" id="oprIniEdit">
    <br>
    E-mail <br>
    <input type="text" name="oprEmail" id="oprEmailEdit">	
    <br>
    Cpr <br>
    <input type="text" name="oprCpr" id="oprCprEdit">
    <br>
    Password <br>
    <input type="button" id="newPassword_But" value="New password">
    <br>
    
    Privileges <br>
    <input type="checkbox" name="AdminRole" id="AdminRoleEdit"> Admin<br>
    <input type="checkbox" name="FarRole" id="FarRoleEdit"> Farmaceut<br>
    <input type="checkbox" name="VeakRole" id="VeakRoleEdit"> Værkfører<br>
    <input type="checkbox" name="LabRole" id="LabRoleEdit"> Laborant <br>  
      
  <br><br>
  <input id="Submit_EditUser" type="button" value="Confirm Edit">
    <p id="Editmsg"></p>
</form> 
</div>
<!--edit user slut-->

<button id="Adduser_But">Add User</button><button id="refresh_But">Refresh List</button><div id="activeCount" class="countBox"></div><div id="inActiveCount" class="countBox"></div><div id="totCount" class="countBox"></div>
<table id="table_con"> 
<tr>  
  <td>Status</td>
  <td>Id</td>
  <td>First Name</td>
  <td>Last Name</td>
  <td>Initials</td>
  <td>E-mail</td>
  <td>Cpr</td>
  <td>Roles</td>
  <td>Delete</td>
  <td>Edit</td>
</tr>
</table>